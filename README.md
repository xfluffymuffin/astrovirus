aln/

Содержит выравнивания различного происхождения:

	- Подпапка main/: основные выравнивания, актуальные на данный момент
		- Подпапка tree_aln/: выравнивания, использовавшиеся для построения деревьев в iqtree, заканчиваются на 'no_amb'. Файлы iqtree (см. папку trees/iqtree_output/) впоследствии пропущены через iTOL для окрашивания по серотипам (см. папку trees/iTOL_output/)
		- Подпапка recomb_analysis_aln/: выравнивания, использовавшиеся для анализа событий рекомбинации - на них использован скрипт gap_check.py (папка scripts/). Включает папку serotypes_aln/: содержит выравнивания по отдельным серотипам, полученные в RDP4 (из выравниваний ORF_1A_1B_2_conc_RNA_no_amb.fas, ORF_1B_2_conc_RNA_no_amb.fas в папке aln/main/recomb_analysis_aln/)
		- Подпапка pair_dist_aln/: выравнивания для нахождения расстояния между последовательностями - результаты в папаке pairwise_distance/

	
*выравнивания в подпапках main/recomb_analysis_aln/ и main/pair_dist_aln/ частично совпадают - одинаковые файлы были использованы для решения разных задач

------------------------------------------------------------------------------------------------------------------------------------------

genbank/

Содержит gb-файлы (записи с последовательностями) либо ассоциированные с ними файлы (названия записей без даты взятия образца)

------------------------------------------------------------------------------------------------------------------------------------------

genome_coverage/

Содержит созданные скриптом genbank_coverage_complex.py файлы для задания по определению покрытия генома

reference.fas - референсные последовательности серотипов
reference_aln.fas - выравнивание для референсов
Final_cov.txt - данные для построения графика Final_cov_plot.png из подпапки plots/original
file.fasta - скачанные скриптом выравненные на референсы последовательности

	- Подпапка plots/: содержит графики
		- Подпапка original/: исходные графики покрытия, включая графики для каждого серотипа в 			отдельности
		- *Подпапка inkscape_modified/: графики (Final_plot_cov, а также breakpoint distribution plot и recombination region count matrix, полученные в RDP по выравниванию ORF_1A_1B_2_conc_RNA_no_amb.fas), переведенные в векторный формат и модифицированные с помощью Inkscape - данные с графиков сопоставлены с добавленными схемами генома

* svg-файл recombination_region_count_matrix.svg из папки genome_coverage/plots/inkscape_modified/ не уместился в лимит в 25 MB, поэтому на него есть ссылка в текстовом файле

------------------------------------------------------------------------------------------------------------------------------------------

add_info/

Содержит вспомогательные файлы:

gbid_serotype_corresp.csv - соответствия gb_id и серотпиов
orf_data.csv - координаты рамок из gb-файла с записями

------------------------------------------------------------------------------------------------------------------------------------------

trees/

Содержит выходные файлы после построения деревьев:

	- Подпапка iqtree_output/: файлы iqtree, без визуализации; для построения деревьев использованы выравнивания из папки aln/main/tree_aln/
	- Подпапка iTOL_output/: сгенерированные iTOL файлы - деревья в нескольких форматах (newick, phyloxml), аннотация деревьев
		- Подпапки pics/ для папок с деревьями: изображения деревьев в *.png и *.pdf
	
------------------------------------------------------------------------------------------------------------------------------------------

parwise_distance/

Содержит полученные в MEGA v11 данные о расстояниях между белковыми и нуклеотидными последовательностями по двум последним и по всем трем рамкам (подпапки aa/, nucl/), а также соответствующие графики (подпапки aa_plot/, nucl_plot/)

Выравнивания для выполнения этого задания можно найти в папке aln/main/pair_dist_aln/
В заголовках графиков имеется информация о выравниваниях, а также о выходных *.csv файлах.

------------------------------------------------------------------------------------------------------------------------------------------

RDP/

Содержит проанализированные в RDP проверенные события рекомбинации:

Для выравнивания всей выборки
(исходные выравнивания - ORF_1A_1B_2_conc_RNA_less_amb_fewer_gaps.fas, ORF_1B_2_conc_RNA_frame_fixed_less_amb_fewer_gaps.fas из папки aln/main/recomb_analysis_aln/):

	- Подпапка 1a_1b_2: по полногеномному выравниванию
	- Подпапка 1b_2: по выравниванию двух последних рамок

Для выравнивания по серотипам
(исходные выравнивания - aln/main/recomb_analysis_aln/serotypes_aln/): 

	- Подпапка 1a_1b_2_serotypes: по полногеномному выравниванию
	- Подпапка 1b_2_serotypes: по выравниванию двух последних 	рамок

------------------------------------------------------------------------------------------------------------------------------------------

old/

Содержит устаревшие файлы проекта, замененные обновленными (могут пригодиться больше, чем не перекочевавшие сюда из старого репозитория)

	- Подпапка aln_old/: промежуточные, более не актуальные выравнивания; перемещаются сюда из подпапки aln/main/
	- Подпапка rdp_old/: старые RDP-проекты и выходную информацию о них в формате *.csv
	- Подпапка trees_old/: старые файлы, связанные с построением деревьев. Папка old_annot/ -  с устаревшей аннотацией

scripts/

Содержит написанные для проекта скрипты вместе с входными и выходными файлами, даже если это дубликаты уже имеющихся файлов в других папках (так папку scripts можно использовать независимо от ее расположения)

        genecds_create_csv.py

Программа для создания csv-файла по записям из полей CDS, genes записей GenBank

Последовательно запускаются две функции:

1) launch_gene_cds_field_distribution()
Функция запускает скрипт gene_cds_field_distribution.py с помощью следующей внутренней команды:
python genecds_field_distribution.py -input Mamastrovirus_1_complete_genome_records.gb -odir alignment_of_orfs_output -oname Mamastrovirus_1_gene_product_output.txt
Выходной файл такой же, как и у запускаемого изнутри скрипта: Mamastrovirus_1_gene_product_output.txt

2) gene_cds_field_distribution_output_handle()
Функция непосредственно создает необходимый csv-файл на основании выходного файла предыдущей функции
Если строка поля CDS/gene – это слово orf1/orf1a, либо в строке имеется “unknown”, “protease”, “NS”, то после запятой добавляется “1A”.
Строка – “orf1b” или в строке “polymerase” – добавляется “1B”/
В строке “Non” – добавляется “1AB”.
В строке “non” – добавляется “1A”, “1B” и “1AB”.
Иначе добавляется “2”.
Скрипт genecds_field_distribution.py и файл с GenBank-записями Mamastrovirus_1_complete_genome_records.gb должны находиться в той же директории, что и сам genecds_create_csv.py.

					
        parse_gb_records.py

Программа для получения отдельных данных записей GenBank из NCBI

Использует четыре библиотеки: pandas, biopython, collections, pickle, а также модуль os.path.
1) Вначале создается словарь res, который в будущем будет содержать часть данных из записей GenBank.
2) Затем проверяется наличие файла dict_data.txt, содержащего данные словаря res. Файл создается после первого запуска программы и необходим, чтобы избегать повторного скачивания GenBank-записей при каждом новом запуске программы – удобно, если нужно, к примеру, поменять что-либо в формате вывода данных. Для повторного скачивания данных необходимо перед запуском скрипта удалить dict_data.txt.
3) Далее при отсутствии dict_data.txt выполняется функция get_gb_records(query), где query – запрос, отправляемый на сервер NCBI (к базе данных NCBI Nucleotide). Функция выполняет три задачи: скачивание данных из GenBank, запись данных некоторых квалификаторов в словарь res и сохранение всех скачанных записей GenBank в файл records.gb.
Если dict_data.txt уже существует, то из него подгружаются данные GenBank записей, сохраненные ранее в словарь res, и функция get_gb_records игнорируется.
4) Затем функцией file_writer() данные из словаря res сохраняются в датафрейм pandas, оттуда – в файл metadata.csv (ныне файл заменен аналогом metadata_serotypes_fixed.csv)
5) Часть данных, сохраненная в словаре res, выводится в файл main_ output.txt
Переменной query было передано следующее значение:
"Mamastrovirus 1"[porgn] AND "6000"[SLEN] : "8000"[SLEN]
Содержимое main_output.txt частично приведено ниже (результат скачивания данных по запросу):

///
Загружено 125 записей

Образцы выделены в следующих точках мира (чаще всего China: 19 раз(а)):
China: 19
France: 15
Brazil: 15
...

Виды-хозяева вирусов: 
Homo sapiens: 84
NaN: 25
...

Даты взятия образцов: 
NaN: 17
2015: 10
2014: 5
...

Штаммы: 
NaN: 75
Oxford: 8
Dresden: 2
...

Известная информация о серотипах/пациентах: 
NaN: 35
Child with acute gastroenteritis: 3
V1347: 2
...

Источники выделения: 
NaN: 47
stool: 20
sewage: 20
...

///

        clean_records.py

Удаляет из *.fasta-файла последовательности, содержащие "sewage" в заголовке - для избавления от образцов из сточных вод (использован на примере Mamastrovirus_1_complete_genome_records.fasta из папки genbank/)
					
        fasta_header_editor.py

Добавляет в заголовки *.fasta-файлов информацию о серотипах (например, _serotype_1), используя файл с аннотацией iTOL, где каждому серотипу присвоен свой цвет

При запуске из папки скрипт сработает на файлах из старого репозитория, на которых работал изначально:
ORF2_cleared_alignment.fas из папки old/aln_old/
ORF2_RNA_tree_ann.txt из папки old/trees_old/old_annot/
					
        metadata_editor.py


Аналогичен fasta_header_editor.py, но корректирует metadata.csv, превращая его в metadata_serotypes_fixed.csv
					
        fix_rdp_csv.py

*.fasta-файлы, полученные на выходе RDP4, содержали неполые заголовки, этот скрипт их восстанавливает до полной длины по выравниванию ORF_1A_1B_2_conc_RNA_no_amb.fas из папки aln/main/
					
        gap_check.py

Запускается через командную строку. Использовался на выравниваниях ORF_1A_1B_2_conc_RNA_less_amb_fewer_gaps.fas и ORF_1B_2_conc_RNA_frame_fixed_less_amb_fewer_gaps.fas из папки aln/main/recomb_analysis_aln/.
Папка со скриптом также содержит выходные файлы.

Удаляет последовательность из выравнивания, если в ней длина цепочки гэпов превышает пороговое значение
Помимо обязательного пути к исходному файлу (-i) программе можно подать на вход аргументы -oc (путь к выходному csv-файлу с длинами всех гэпов всех  последовательностей в выравнивании), -of (путь к выходному fasta-файлу, очищенному от замусоренных гэпами последовательностей), -t (пороговое значение для числа подряд идущих гэпов, 50 по умолчанию), -e (позволяет исключить из рассмотрения фиксированную длину гэпов, когда мы знаем, что именно этот участок определенной длины учитывать не хотим)
